{% extends 'base.html' %}
{% load crispy_forms_tags %}
{% load bootstrap4 %}

{% block title %}
Etsi projekteja tietokannasta
{% endblock %}

{% block content %}

<div class="container">
	<div class="row justify-content-center">
		<div class="col-8">
			<h1 class="mt-2">Etsi projekti</h1>
			<hr class="mt-0 mb-4">
			<form method='get'>
				{% csrf_token %}
				<div class="row">
					<div class="col-6">
						{{ form.start_date|as_crispy_field }}
					</div>
					<div class="col-6">
						{{ form.end_date|as_crispy_field }}
					</div>
				</div>
				<div class="row">
					<div class="col-12">
						<label>
							Rakennustyyppi
						</label>
						<select class="js-example-basic-multiple" name="structure_type" multiple="multiple" style="width: 100%">
							{% for filter in f1 %}
								<option value= "{{ filter }}" > {{ filter }} </option>
							{% endfor %}
						</select>
					</div>
				</div>
				<br>
				<div class="row">
					<div class="col-12">
						<label>
							Rakennusmateriaali
						</label>
						<select class="js-example-basic-multiple" name="building_material" multiple="multiple" style="width: 100%">
							{% for filter in f2 %}
								<option value= "{{ filter }}" > {{ filter }} </option>
							{% endfor %}
						</select>
					</div>
				</div>
				<br>
				<div class="row">
					<div class="col-12">
						<label>
							Palvelu
						</label>
						<select class="js-example-basic-multiple" name="service" multiple="multiple" style="width: 100%">
							{% for filter in f3 %}
								<option value= "{{ filter }}" > {{ filter }} </option>
							{% endfor %}
						</select>
					</div>
				</div>
				<br>
				<div class="row">
					<div class="col-12">
						<label>
							Rakennustoimenpide
						</label>
						<select class="js-example-basic-multiple" name="construction_operation" multiple="multiple" style="width: 100%">
							{% for filter in f4 %}
								<option value= "{{ filter }}" > {{ filter }} </option>
							{% endfor %}
						</select>
					</div>
				</div>
				<br>
				<div class="row">
					<div class="col-12">
						<label>
							Rakenneosa
						</label>
						<select class="js-example-basic-multiple" name="structural_component" multiple="multiple" style="width: 100%">
							{% for filter in f5 %}
								<option value= "{{ filter }}" > {{ filter }} </option>
							{% endfor %}
						</select>
					</div>
				</div>
				<br>
				<div class="row">
					<div class="col-12">
						{{ form.key_phrase_search|as_crispy_field }}
					</div>
				</div>
				<button type="submit" class="btn btn-primary">Etsi</button>
			</form>
		</div>
	</div>
</div>
<br>

{% if result %}

<table id="project_table" class="display responsive" width='100%'>
    <thead>
        <tr>
            <th class='all'>Projektin nimi</th>
            <th class='all'>Kohteen nimi</th>
            <th class='all'>Aloituspäivä</th>
            <th class='all'>Lopetuspäivä</th>
            <th class='min-desktop'>Tyyppi</th>
            <th class='min-desktop'>Materiaali</th>
            <th class='min-desktop'>Palvelu</th>
            <th class='min-desktop'>Toimenpide</th>
            <th class='min-desktop'>Avainsanat</th>
            <th class='none'>Projektin kuvaus</th>
            <th class='none'>Polku tiedostojen sijaintiin</th>
            <th class='none'>Projektin vetäjä</th>
        </tr>
    </thead>
    <tbody>
    	{% for item in result %}
       		<tr>
            	<td>{{ item.project_name }}</td>
            	<td>{{ item.destination_name }}</td>
            	<td>{{ item.start_date|date:"d.m.Y" }}</td>
            	<td>{{ item.end_date|date:"d.m.Y" }}</td>
            	<td>{{ item.structure_type }}</td>
            	<td>{{ item.building_material }}</td>
            	<td>{{ item.service }}</td>
            	<td>{{ item.construction_operation }}</td>
            	<td>{{ item.keywords }}</td>
            	<td>{{ item.project_description }}</td>
            	<td>{{ item.documentation_path }}</td>
            	<td>{{ item.project_manager }}</td>
        	</tr>
        {% endfor %}
    </tbody>
</table>

{% endif %}

<script>
	$('#project_table').DataTable( {
	    language: {"url":"https://cdn.datatables.net/plug-ins/1.10.20/i18n/Finnish.json"},
	    searching: false
	} );
</script>

<script>
	$(document).ready(function() {
	    $('.js-example-basic-multiple').select2();
	});
</script>

<script>
	$(".js-example-theme-multiple").select2({
		theme: "classic"
	});
</script>

{% endblock %}